Description: Fix for CVE-2023-33460a
 Memory leak in yajl 2.1.0 with use of yajl_tree_parse function
Origin: https://github.com/openEuler-BaseService/yajl/commit/23a122eddaa28165a6c219000adcc31ff9a8a698
Bug-Debian: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1039984
Bug: https://github.com/lloyd/yajl/issues/250
---
 src/yajl_tree.c | 3 +++
 1 file changed, 3 insertions(+)

--- a/src/yajl_tree.c
+++ b/src/yajl_tree.c
@@ -445,6 +445,9 @@
              YA_FREE(&(handle->alloc), internal_err_str);
         }
         yajl_free (handle);
+	//If the requested memory is not released in time, it will cause memory leakage
+	if(ctx.root)
+	     yajl_tree_free(ctx.root);
         return NULL;
     }
 
